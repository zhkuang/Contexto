# Contexto 初始化与配置验证功能

## 功能概述

为 Contexto 插件添加了完整的项目状态管理和配置验证，包括：

### 1. 项目状态管理
- **未初始化状态**: 显示欢迎界面，引导用户初始化项目
- **配置错误状态**: 检测并显示配置问题，提供解决方案
- **正常运行状态**: 显示翻译管理界面，正常工作流程

### 2. 智能配置验证
- **源语言字典验证**: 检查文件是否存在，格式是否正确
- **目标语言配置验证**: 确保已配置翻译目标语言
- **AI服务配置验证**: 检查API密钥等必要配置
- **路径配置验证**: 验证忽略规则和文件路径有效性

### 3. 配置异常界面
- **错误详情显示**: 清晰展示所有配置错误和警告
- **一键修复功能**: 提供快速创建缺失文件的功能
- **配置指导**: 给出详细的配置修复建议

## 技术实现

### 新增文件
1. `configErrorWebview.ts` - 配置错误界面webview提供者
2. `types.ts` - 新增ProjectStatus和ConfigValidation类型

### 核心功能
1. **ContextoCore.validateConfig()** - 配置验证核心方法
2. **项目状态追踪** - 实时跟踪项目初始化和配置状态
3. **智能界面切换** - 根据项目状态自动显示相应界面

### 界面状态控制
- `contexto.showWelcome` - 控制欢迎界面显示
- `contexto.showConfigError` - 控制配置错误界面显示  
- `contexto.showTranslationManager` - 控制翻译管理界面显示

## 配置验证详情

### 错误级别检查 (必须修复)
- ✅ 源语言字典文件存在性检查
- ✅ 源语言字典文件JSON格式验证
- ✅ 必要配置项完整性检查

### 警告级别检查 (建议修复)
- ⚠️ AI服务配置完整性
- ⚠️ 目标语言列表配置
- ⚠️ 忽略规则合理性

### 自动修复功能
- 🔧 **创建源语言字典文件**: 当文件不存在时，一键创建空的JSON文件
- 🔧 **打开配置文件**: 直接跳转到配置文件进行编辑
- 🔧 **重新检测配置**: 修改后立即验证配置状态

## 用户体验流程

### 首次使用流程
1. **打开项目** → 显示欢迎界面
2. **点击初始化** → 创建配置文件并打开编辑
3. **保存配置** → 自动检测配置状态
4. **配置有误** → 显示配置错误界面
5. **修复配置** → 切换到正常翻译管理界面

### 配置错误处理流程
1. **检测到配置错误** → 自动显示配置异常界面
2. **查看错误详情** → 列出所有错误和警告
3. **一键修复** → 提供快速解决方案
4. **重新检测** → 验证修复结果

### 状态栏提示
- 🌍 **未初始化**: "Contexto: 未初始化"
- ⚠️ **配置异常**: "Contexto: 配置异常" 
- ✅ **正常运行**: "Contexto: X个待处理" 或 "Contexto: 已同步"

## 配置文件示例

```json
{
    "sourceLangDict": "./locales/zh-CN.json",
    "targetLangs": ["en", "ja", "ko"],
    "ignore": ["./contexto", "./node_modules", "./.git"],
    "aiService": {
        "type": "openai",
        "apiKey": "your-api-key",
        "base": "https://api.openai.com/v1",
        "model": "gpt-4"
    }
}
```

## 设计特点

- 🎯 **智能检测**: 每次进入项目都会自动检测配置有效性
- 🔧 **自助修复**: 提供多种自动修复和快速解决方案
- � **详细反馈**: 清晰展示所有配置问题和修复建议
- 🔄 **实时更新**: 配置修改后立即重新验证状态
- 🎨 **一致设计**: 完全融入VS Code原生界面风格
