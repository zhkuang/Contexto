# Contexto 配置页面使用指南

## 功能概述

新增的配置页面提供了一个图形化界面来管理 Contexto 项目的配置，无需直接编辑 JSON 文件。

## 访问配置页面

1. 在 VS Code 中打开包含 Contexto 项目的工作区
2. 在左侧活动栏中点击 Contexto 图标（地球图标）
3. 在翻译管理面板中，点击顶部工具栏的"打开配置"按钮（齿轮图标）

## 配置页面功能

### 1. 基础配置
- **源语言字典文件**：选择包含原始文本的 JSON 文件
  - 点击"选择文件"按钮可以浏览并选择文件
  - 支持相对路径显示

### 2. 目标语言配置
- **添加目标语言**：点击"+ 添加目标语言"按钮
- **语言代码**：输入目标语言代码（如：en, zh-TW, ja）
- **输出路径配置**：点击"选择路径"按钮有两种选择方式：
  - **选择现有文件**：浏览并选择一个现有的 JSON 文件
  - **选择目录**：选择目录后系统会自动生成 `[语言代码].json` 文件名
- **智能路径更新**：当选择目录后，修改语言代码会自动更新文件名
- **默认路径**：如果不指定路径，会使用默认路径：`./contexto/locales/[语言代码].json`
- **删除语言**：点击"删除"按钮移除不需要的目标语言

### 3. 忽略路径配置
- **添加忽略路径**：点击"+ 添加忽略路径"按钮
- **路径配置**：输入需要在扫描时忽略的文件或目录路径
- **默认忽略**：
  - `./contexto` - 插件自身目录
  - `./node_modules` - Node.js 依赖目录
  - `./.git` - Git 版本控制目录

### 4. AI 服务配置
- **服务类型**：目前支持 OpenAI
- **API Key**：输入您的 AI 服务 API 密钥（必填）
- **API 基础地址**：AI 服务的 API 基础 URL（必填）
- **模型名称**：使用的 AI 模型名称（必填）
- **测试连接**：点击"测试连接"按钮验证 AI 服务配置是否正确
  - 会执行一个简单的翻译测试（"你好" -> 英语）
  - 测试成功会显示翻译结果
  - 测试失败会显示错误信息

## 保存配置

1. 填写完所有必填项后，点击"保存配置"按钮
2. 系统会自动验证配置的有效性
3. 如果验证失败，会显示具体的错误信息
4. 保存成功后会自动刷新项目状态

## 配置验证

配置页面会自动验证以下内容：

### 必填项验证
- 源语言字典文件路径不能为空
- 至少需要配置一个目标语言
- 目标语言代码不能为空
- AI 服务类型、API Key、API 基础地址、模型名称都不能为空

### 错误处理
- 如果有验证错误，会在页面底部显示详细的错误信息
- 每个错误都会明确指出问题所在
- 修复错误后可以重新保存

## 使用技巧

1. **文件路径选择**：建议使用界面提供的文件选择功能，确保路径正确
2. **目标语言管理**：可以随时添加或删除目标语言，灵活配置翻译需求
3. **AI 服务测试**：在保存配置前建议先测试 AI 服务连接，确保翻译功能正常
4. **配置备份**：重要配置建议手动备份 `contexto/config.json` 文件

## 常见问题

### Q: 配置页面无法打开？
A: 确保项目已经初始化，如果是新项目，需要先在欢迎页面点击"初始化项目"。

### Q: AI 服务测试失败？
A: 检查以下几点：
- API Key 是否正确
- API 基础地址是否可访问
- 模型名称是否正确
- 网络连接是否正常

### Q: 保存配置后没有生效？
A: 保存配置后系统会自动刷新，如果仍有问题，可以手动点击刷新按钮或重新加载 VS Code 窗口。

### Q: 如何恢复默认配置？
A: 可以删除 `contexto/config.json` 文件，然后重新初始化项目。

## 页面风格

配置页面采用 VS Code 原生主题样式，确保与编辑器界面保持一致：
- 使用 VS Code 的颜色主题
- 支持深色和浅色主题自动切换
- 界面简洁，功能分区清晰
- 表单验证反馈及时明确
